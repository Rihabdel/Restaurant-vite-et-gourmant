<section class="menu-section text-center">
  <div class="menu-section-header mb-4">
        <h2 class="section-title">Nos cartes de menus pour vos événements</h2>
        <p class="section-subtitle">Découvrez nos offres personnalisées pour rendre vos événements inoubliables grâce à notre service traiteur de qualité.</p>
            <!-- Filtres -->
            <div class="filters-section">
              <div class="section-subtitle mb-3">
              <button class="btn btn-filtres" data-bs-toggle="collapse" href="#filtresCollapse" onclick="" aria-expanded="false" aria-controls="filtresCollapse" onkeypress="onmouseover"><i class="bi bi-funnel"></i> Filtrer les cartes de menus par</button>
              </div>
                <div class="collapse" id="filtresCollapse"> 
              <div class="container filter">
                    <div class="">
                        <label for="fourchetteFilter" class="form-label">Fourchette de prix</label>
                        <select class="form-select" id="fourchetteFilter">
                            <option value="all">Tous</option>
                            <option value="low">Faible (&lt; 10€)</option>
                            <option value="medium">Moyen (10€ - 50€)</option>
                            <option value="high">Élevé (&gt; 50€)</option>
                        </select>
                    </div>
                    <div class="d-flex flex-column align-items-center">
                        <label for="prixFilter" class="form-label">Prix</label>
                        <input type="range" class="form-range" min="0" max="100" step="5" id="prixFilter">
                        <span>0-110€</span>
                    </div>
                    
                    <div class="">
                        <label for="personnesFilter" class="form-label">Nombre des personnes</label>
                        <select aria-label="Nombre des personnes" class="form-select" id="personnesFilter">
                            <option value="all">Tous</option>
                            <option value="1-19">Moins de 20 personnes</option>
                            <option value="20-50">Entre 20 et 50 personnes</option>
                            <option value="51-100">Entre 51 et 100 personnes</option>
                            <option value="101-200">Entre 101 et 199 personnes</option>
                            <option value="200+">200 personnes et plus</option>
                        </select>
                    </div>
                    <div class="">
                        <label for="Theme" class="form-label">Thème</label>
                        <select aria-label="Thème" class="form-select" id="themeFilter">
                            <option value="all">Tous</option>
                            <option value="anniversaire">Anniversaire</option>
                            <option value="classique">Classique</option>
                            <option value="mariage">Mariage</option>
                            <option value="bapteme">Bapteme</option>
                            <option value="entreprise">Entreprise</option>
                            <option value="familiale">Familiale</option>
                            <option value="noel">Noël</option>
                            <option value="autres">Autres</option>
                        </select>
                    </div>
                    <div class="">
                        <label for="dietFilter" class="form-label">Régime</label>
                        <select aria-label="Régime" class="form-select" id="dietFilter">
                            <option value="all">Tous</option>
                            <option value="classique">Classique</option>
                            <option value="vegetarian">Vegetarien</option>
                            <option value="vegan">Vegan</option>
                            <option value="sans_gluten">Sans Gluten</option>
                            <option value="autres">Autres</option>
                        </select>
                    </div>
                    
                    <div class="d-flex align-items-end">
                        <button class="btn btn-outline-primary w-100" id="resetFilters">
                            <i class="bi bi-arrow-counterclockwise"></i> Réinitialiser
                        </button>
                    </div>
                </div>
              
            </div>
            </div>
  </div>
    <div class="menu-section-content">
    <div class="text-center mb-4">
      <!-- Button trigger modal -->
      <button type="button" class="btn btn-success" data-bs-toggle="modal" data-bs-target="#editMenuModal" id="add-Menu-Btn" data-show="ROLE_ADMIN,ROLE_EMPLOYEE" style="display: none;">
          Ajoutez une nouvelle carte de menu
      </button>
    </div>
<div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4 menu-cards" id="menu-cards-container">
<div class="col">
    <div class="menu-card h-100">
      <div class="card-image">
    <img src="/scss/images/38f4dbfaeaa1ef70459774f52e75713a.jpg" class="card-img-top" alt="...">
        <div class="action-image-buttons" data-show="ROLE_ADMIN,ROLE_EMPLOYEE" style="display: none;">
            <button class="btn btn-outline-light edit-menu-btn" data-id="${menu.id}" data-show="ROLE_ADMIN,ROLE_EMPLOYEE"><i class="bi bi-pencil"></i>Modifier</button>
            <button class="btn btn-outline-light delete-menu-btn" data-id="${menu.id}" data-show="ROLE_ADMIN,ROLE_EMPLOYEE"><i class="bi bi-trash"></i>Supprimer</button>
        </div>
      </div>

    <div class="card-footer">
        <button class="btn btn-primary view-detail-btn" data-id="${menu.id}" data-bs-toggle="modal" data-bs-target="#detailscarteModal">voir le détail de menu</button>
    </div>
    <div class="action-card-buttons" data-show="ROLE_ADMIN,ROLE_EMPLOYEE" style="display: none;">
            <button class="btn btn-success edit-menu-btn" data-id="${menu.id}" data-bs-toggle="modal" data-bs-target="#editMenuModal"><i class="bi bi-pencil"></i>Modifier</button>
            <button class="btn btn-danger delete-menu-btn" data-id="${menu.id}" data-bs-toggle="modal" data-bs-target="#deleteMenuModal"><i class="bi bi-trash"></i>Supprimer</button>
      </div>
    </div>
</div>

</div>
    </div>
</section>

<!-- Modal d'ajout ou modification de menu-->
<div class="modal fade" id="editMenuModal" tabindex="-1" aria-labelledby="editMenuModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="editMenuModalLabel">Ajouter ou Modifier la carte de menu</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form id="editMenuForm">
            <div class="mb-3">
              <label for="menuPicture" class="form-label">Image du menu</label>
              <input type="file" class="form-control" id="menuPicture" name="picture" accept="scss/images/*">
            </div>
            <div id="currentPictureContainer" class="mb-3" style="display: none;">
              <img id="currentPicture" src="" alt="Image actuelle" style="max-width: 200px;">
              <button type="button" class="btn btn-sm btn-danger" id="removePictureBtn">Supprimer l'image</button>
            </div>
            <div class="mb-3">
                <label for="menuTitle" class="form-label">Titre du menu</label>
                <input type="text" class="form-control" id="editMenuTitle" placeholder="Entrez le titre du menu">
            </div>
            <div class="mb-3">
                <label for="menuDescription" class="form-label">Description du menu</label>
                <textarea class="form-control" id="editMenuDescription" rows="3" placeholder="Entrez la description du menu"></textarea>
            </div>
            <div class="mb-3">
                <label for="minPersons" class="form-label">Minimum pour :</label>
                <input type="number" class="form-control" id="editMenuMinPersons" placeholder="Entrez le nombre minimum de personnes">
            </div>
            <div class="mb-3">
                <label for="menuPrice" class="form-label">Prix par personne</label>
                <input type="number" class="form-control" id="editMenuPrice" placeholder="Entrez le prix par personne">
            </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fermer</button>
        <button type="button" class="btn btn-primary" id="saveMenuBtn">Enregistrer les modifications</button>
      </div>
    </div>
  </div>
</div>
<!-- Modal de suppression de menu-->
<div class="modal fade" id="deleteMenuModal" tabindex="-1" aria-labelledby="deleteMenuModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="deleteMenuModalLabel">Supprimer la carte de menu</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="mb-3">
            <p>Êtes-vous sûr de vouloir supprimer cette carte de menu ? Cette action est irréversible.</p>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fermer</button>
          <button type="button" class="btn btn-danger">Supprimer</button>
        </div>
    </div>
  </div>
</div>

<!-- modal details de la carte de menu -->
<div class="modal fade" id="detailscarteModal" aria-hidden="true" aria-labelledby="detailscarteModalToggleLabel" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered modal-lg details">
    <div class="modal-content">
      <div class="modal-body" id="detailsMenuContent">
          <div class="container menu-card-detail">
                      <h2 class="Menu-title text-center ">titre du menu</h2>
                        <div class="menu-category" id="entrees-container">
                            <h3><i class="bi bi-egg-fried"></i> Entrées</h3>
                            <div class="menu-item">
                                <div class="row row-cols-2 menu-item-header">
                                    <div class="col-lg-10 menu-item-title">Foie Gras Maison</div>
                                    <div class="col-lg-2 menu-item-price">18€</div>
                                </div>
                                <p class="menu-item-description">Préparé selon la recette familiale, servi avec sa confiture d'oignons et toast brioché</p>
                                <small ><i class="bi bi-exclamation-triangle-fill"></i> Contient de $allergene</small>
                            </div> 
                          </div>    
                        <div class="menu-category" id ="plats-container">
                            <h3><i class="bi bi-cup-hot"></i> Plats Principaux</h3>
                            <div class="menu-item">
                                <div class="row row-cols-2 menu-item-header">
                                    <div class="col-lg-10 menu-item-title">Magret de Canard aux Cèpes</div>
                                    <div class="col-lg-2 menu-item-price">28€</div>
                                </div>
                                <p class="menu-item-description">Magret grillé, sauce au vin de Saint-Émilion, cèpes de Gironde et pommes de terre sautées</p>
                                <small ><i class="bi bi-exclamation-triangle-fill"></i> Contient de $allergene</small>
                            </div>
                        </div>   
                        <div class="menu-category" id="desserts-container">
                            <h3><i class="bi bi-cake2"></i> Desserts</h3>
                            <div class="menu-item">
                                <div class="row row-cols-2 menu-item-header">
                                    <div class="col-lg-10 menu-item-title">Canelés Bordelais</div>
                                    <div class="col-lg-2 menu-item-price">9€</div>
                                </div>
                                <p class="menu-item-description">Spécialité bordelaise, dorés et caramélisés à l'extérieur, moelleux à l'intérieur</p>
                                <small ><i class="bi bi-exclamation-triangle-fill"></i> Contient de $allergene</small>
                            </div>
                          </div>
                          <div class="totalPrice">
            <h4 class="text-center mt-4">Prix total par personne : 45 Euros</h4>
            </div>
          </div>
      </div>
      <div class="container mb-4 info-section">
          <div class="info-header">
              <h5>Allergènes et informations supplémentaires :</h5>
          <div class="info-content">
            <ul>
        <li><i class="bi bi-info-circle-fill"></i><small> Ce menu est conçu pour un minimum de [20-50] personnes.</small></li>
        <li><i class="bi bi-exclamation-triangle-fill"></i><small>Ce menu nécessite une commande x jours à l'avance.</small></li>
      <li><i class="bi bi-exclamation-triangle-fill"></i><small> Merci de consulter notre liste complète des allergènes pour éviter tout risque.</small></li>
      <li><i class="bi bi-info-circle-fill"></i><small>Contactez notre équipe pour toute demande spéciale ou question concernant le menu.</small></li>
            </ul>
          </div>
          </div>
      </div>
      <div class="modal-footer d-flex justify-content-center">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Ajouter au panier</button>
        <button class="btn btn-primary" data-bs-target="#recapCommandeModal" data-bs-toggle="modal" id="confirm-order-btn">Commander</button>
      </div>
      <div class ="modal-footer d-flex justify-content-center"  data-role="admin,employee">
        <button type="button" class="btn btn-success" data-bs-target="#editCarteMenu" data-bs-toggle="modal">modifier la carte </button>
        <button type="button" class="btn btn-danger" data-bs-target="#deleteMenuModal" data-bs-toggle="modal">supprimer la carte </button>  
      </div>
  
  </div>
</div>
</div>

<!---modal recap de la commande de menu-->
<div class="modal fade" id="recapCommandeModal" aria-hidden="true" aria-labelledby="recapCommandeModalLabel" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered recap-commande-modal*">
    <div class="modal-content">
      <div class="modal-body">
        <form>
          <div class="container-fluid">
          <div class="row">Vos récapitulatifs de la commande :</div>
          <div class="row">
            <div class="col mb-3">
                <label for="customerName" class="form-label">Nom du client</label>
                <input type="text" class="form-control" id="customerName" placeholder="Entrez votre nom">
            </div>
            <div class="col mb-3">
                <label for="customerPrenom" class="form-label">Prénom du client</label>
                <input type="text" class="form-control" id="customerPrenom" placeholder="Entrez votre prénom">
            </div>
          </div>
          <div class="row">
            <div class="col mb-3">
                <label for="customerEmail" class="form-label">Email du client</label>
                <input type="email" class="form-control" id="customerEmail" placeholder="Entrez votre email">
            </div>
            <div class="col mb-3">
                <label for="customerPhone" class="form-label">Numéro de téléphone</label>
                <input type="tel" class="form-control" id="customerPhone" placeholder="Entrez votre numéro de téléphone">
            </div>
          </div>
          <div class="row facture">
            <div class="col mb-3">
                <label for="customerAddress" class="form-label">Adresse de facturation</label>
                <input type="text" class="form-control" id="customerAddress" placeholder="Entrez votre adresse">
            </div>
            <div class="col mb-3">
                <label for="factDate" class="form-label">Date de facturation</label>
                <input type="text" class="form-control" id="factDate" placeholder="Entrez votre adresse">
            </div>
            </div>
            <div class="delivery row">
            <div class="mb-3">
                <label for="deliveryAddress" class="form-label">Adresse de livraison</label>
                <input type="text" class="form-control" id="deliveryAddress" placeholder="Entrez votre adresse">
                <small class="form-text">5 euros de livraison majoré de 59 centimes par kilomètre parcourus</small>
            </div>
            <div class="col mb-3">
                <label for="deliveryDate" class="form-label">Date de livraison</label>
                <input type="date" class="form-control" id="deliveryDate">
            </div>
            <div class="col mb-3">
                <label for="deliveryTime" class="form-label">Heure de livraison</label>
                <input type="time" class="form-control" id="deliveryTime">
            </div>
            </div>
            <div class="row">
            <div class="col mb-3">
                <label for="menuTitle" class="form-label">Titre du menu :</label>
                <select class="form-select" id="menuTitle2">
                    <option value="menu1">menu choisi par défaut</option>
                    <option value="menu2">Menu 2</option>
                    <option value="menu3">Menu 3</option>
                </select>
                <label for="menuQuantity" class="form-label"placeholder="minimum">Nombre de personnes :</label>
                <input type="number" class="form-control" id="menuQuantity" placeholder="Entrez le nombre de personnes">
                <small class="form-text">Minimum de [20-50] personnes</small></br>
            </div>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-toggle="modal" data-bs-target="#detailscarteModal">Retour</button>
        <button type="button" class="btn btn-primary"  data-bs-target="#detailsCommandeModal" data-bs-toggle="modal">Confirmer vos informations</button>
      </div>
    </div>
  </div>
</div>
</div>
<!--détails de la commande-->
<div class="modal fade" id="OrderDetailsModal" aria-hidden="true" aria-labelledby="detailsCommandeModalLabel" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered details-commande-modal*">
    <div class="modal-content">
      <div class="modal-body">
        <h5>Détails de votre commande :</h5>
        <p>Voici un récapitulatif de votre commande avant confirmation :</p>
        <ul>
          <li><strong>Nom du client :</strong> <span id="detailsName"></span></li>
          <li><strong>Prénom du client :</strong> <span id="detailsPrenom"></span></li>
          <li><strong>Email du client :</strong> <span id="detailsEmail"></span></li>
          <li><strong>Numéro de téléphone :</strong> <span id="detailsPhone"></span></li>
          <li><strong>Menu commandé :</strong> <span id="detailsMenu"></span></li>
          <li><strong>Nombre de personnes :</strong> <span id="detailsQuantity"></span></li>
          <li><strong>Date de livraison :</strong> <span id="detailsDeliveryDate"></span></li>
          <li><strong>Heure de livraison :</strong> <span id="detailsDeliveryTime"></span></li>
          <li><strong>Adresse de livraison :</strong> <span id="detailsAddress"></span></li>
          <li><strong>Coût total :</strong> <span id="detailsTotalPrice"></span></li>
        </ul>
        <p class="text-danger">Veuillez vérifier les détails de votre commande avant de confirmer. Toute modification après confirmation peut entraîner des frais supplémentaires.</p>
          </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Retour</button>
        <button type="button" class="btn btn-primary" id="pay-order-btn" data-bs-dismiss="modal" id="pay-order-btn">payer</button>
      </div>
    </div>
  </div>  
</div>

<!---modal paiement de menu-->
<div class="modal fade" id="paiementModal" aria-hidden="true" aria-labelledby="paiementModalToggleLabel" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered paiement-modal*">
    <div class="modal-content">
      <div class="modal-body">
        <form>
            <div class="mb-3">
                <label for="cardNumber" class="form-label">Numéro de carte</label>
                <input type="text" class="form-control" id="cardNumber" placeholder="Entrez le numéro de votre carte">
            </div>
            <div class="mb-3">
                <label for="cardExpiry" class="form-label">Date d'expiration</label>
                <input type="text" class="form-control" id="cardExpiry" placeholder="MM/AA">
            </div>
            <div class="mb-3">
                <label for="cardCVC" class="form-label">CVC</label>
                <input type="text" class="form-control" id="cardCVC" placeholder="Entrez le code CVC">
            </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-toggle="modal" data-bs-target="#commandeModal">Retour</button>
        <button type="button" class="btn btn-primary">Payer maintenant</button>
      </div>
    </div>
  </div>
</div>


<!--modifier les plats par l'employée-->
<div class="modal fade" id="editCarteMenu" aria-hidden="true" aria-labelledby="detailscarteModalToggleLabel" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered modal-lg details">
    <div class="modal-content">
      <div class="modal-body">
          <div class="container plat-card-detail">
            <form>
                      <h2 class="text-center ">
                        <label for="menuTitleEdit" class="form-label">Modifier le titre du menu</label>
                        <input type="text" class="form-control" id="menuTitleEdit" placeholder="Entrez le titre du menu">
                      </h2>
                      
                        <div class="menu-category">
                            <h3><i class="bi bi-egg-fried"></i> Entrées</h3>
                            <div class="menu-item">
                                <div class="row row-cols-2 menu-item-header">
                                    <div class="col-lg-10 menu-item-title">
                                      <select>selectionnez une entrée
                                        <option value="entree1">Foie Gras Maison</option>
                                        <option value="entree2">Salade de Chèvre Chaud</option>
                                        <option value="entree3">Tartare de Saumon</option>
                                      </select>
                                    </div>
                                    <div class="col-lg-2 menu-item-price">$entree[prix]</div>
                                </div>
                                <p class="menu-item-description">$entree[description]</p>
                                <small ><i class="bi bi-exclamation-triangle-fill"></i>entree[allergene]</small>
                            </div> 
                          </div>    
                        <div class="menu-category">
                            <h3><i class="bi bi-cup-hot"></i> Plats Principaux</h3>
                            <div class="menu-item">
                                <div class="row row-cols-2 menu-item-header">
                                    <div class="col-lg-10 menu-item-title">
                                      <select>selectonnez un plat principale
                                        <option value="plat1">Magret de Canard aux Cèpes</option>
                                        <option value="plat2">Poisson à la Bordelaise</option>
                                        <option value="plat3">Entrecôte Grillée</option>
                                      </select>
                                    </div>
                                    <div class="col-lg-2 menu-item-price">$plat[prix]</div>
                                </div>
                                <p class="menu-item-description">$plat[description]</p>
                                <small ><i class="bi bi-exclamation-triangle-fill"></i>$plat[allergene]</small>
                            </div>
                        </div>   
                        <div class="menu-category">
                            <h3><i class="bi bi-cake2"></i> Desserts</h3>
                            <div class="menu-item">
                                <div class="row row-cols-2 menu-item-header">
                                    <div class="col-lg-10 menu-item-title">
                                      <select>selectionnez un dessert
                                        <option value="dessert1">Canelés Bordelais</option>
                                        <option value="dessert2">Tarte aux Fraises</option>
                                        <option value="dessert3">Mousse au Chocolat</option>
                                      </select> 
                                    </div>
                                    <div class="col-lg-2 menu-item-price">$dessert[prix]</div>  
                                    <p class="menu-item-description">$dessert[description]</p>
                                    <small ><i class="bi bi-exclamation-triangle-fill"></i>$dessert[allergene]</small>
                                    </div>
                                </div>
                            </div>
           </div>
      </div>
      <div class="modal-footer d-flex justify-content-center">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fermer</button>
        <button class="btn btn-primary">Enregistrer les modifications</button>
      </div>
    </div>
  </div>
</div>


<div class="collapse" id="collapseformCarte">
  <div class="card card-body">
         <form >
              <div class="mb-3">
                <h4 for="platType" class="form-label">Categorie</h4>
                <label for="platTypeEdit" class="form-label">Modifier la catégorie du plat</label>
                <select class="form-control" id="platTypeEdit">
                  <option value="" disabled selected>Entrée</option>
                  <option value="menu1">Plat principale</option>
                  <option value="menu2">Desserts</option>
                </select>
              </div>
              <div class="mb-3">
                <label for="platNomEdit" class="form-label">Nom du plat</label>
                <input type="text" class="form-control" id="platNomEdit" value="Nom du plat">
              </div>
              <div class="mb-3">  
                <label for="platDescriptionEdit" class="form-label">Description du plat</label>
                <textarea class="form-control" id="platDescriptionEdit" rows="3">Description du plat</textarea>
                
                <label for="allergeneSelectEdit" class="form-label">Allergène</label>
                <select class="form-select mt-2" id="allergeneSelectEdit">
                  <option value="" disabled selected>Choisir un allergène</option>
                  <option value="gluten">Gluten</option>
                  <option value="produits_laitiers">Produits laitiers</option>
                  <option value="oeufs">Œufs</option>
                  <option value="soja">Soja</option>
                </select>
              </div>
              <div class="mb-3">
                <label for="platPrixEdit" class="form-label">Prix du plat</label>
                <input type="number" class="form-control" id="platPrixEdit" value="Prix du plat">
              </div>
            </form>
  </div>
</div>



<script type="module" src="../js/menu.js"></script>
